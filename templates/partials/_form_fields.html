
{# templates/partials/_form_fields.html #}
{% load static %}
{% load widget_tweaks %}

{% if form.non_field_errors %}
    <div class="alert alert-danger">{{ form.non_field_errors }}</div>
{% endif %}

<fieldset class="module aligned">

    {# --- CAMPOS DE INFORMAÇÕES PESSOAIS --- #}
    <div class="row mb-3 align-items-center">
        <label class="col-md-3 col-form-label text-md-end">{{ form.username.label }}</label>
        <div class="col-md-9">{{ form.username|add_class:"form-control" }}</div>
        {% for error in form.username.errors %}<div class="text-danger offset-md-3 col-md-9">{{ error }}</div>{% endfor %}
    </div>
    <div class="row mb-3 align-items-center">
        <label class="col-md-3 col-form-label text-md-end">{{ form.first_name.label }}</label>
        <div class="col-md-9">{{ form.first_name|add_class:"form-control" }}</div>
        {% for error in form.first_name.errors %}<div class="text-danger offset-md-3 col-md-9">{{ error }}</div>{% endfor %}
    </div>
    <div class="row mb-3 align-items-center">
        <label class="col-md-3 col-form-label text-md-end">{{ form.last_name.label }}</label>
        <div class="col-md-9">{{ form.last_name|add_class:"form-control" }}</div>
        {% for error in form.last_name.errors %}<div class="text-danger offset-md-3 col-md-9">{{ error }}</div>{% endfor %}
    </div>
    <div class="row mb-3 align-items-center">
        <label class="col-md-3 col-form-label text-md-end">{{ form.email.label }}</label>
        <div class="col-md-9">{{ form.email|add_class:"form-control" }}</div>
        {% for error in form.email.errors %}<div class="text-danger offset-md-3 col-md-9">{{ error }}</div>{% endfor %}
    </div>
    <hr class="my-4">

    {# --- CAMPOS DE STATUS E PERMISSÃO --- #}
    <div class="row mb-3">
        <label class="col-md-3 col-form-label text-md-end">Status</label>
        <div class="col-md-9">
            <div class="form-check">
                {{ form.is_active|add_class:"form-check-input" }}
                <label for="{{ form.is_active.id_for_label }}" class="form-check-label">{{ form.is_active.label }}</label>
            </div>
            <div class="form-check">
                {{ form.is_staff|add_class:"form-check-input" }}
                <label for="{{ form.is_staff.id_for_label }}" class="form-check-label">{{ form.is_staff.label }}</label>
            </div>
            <div class="form-check">
                {{ form.is_superuser|add_class:"form-check-input" }}
                <label for="{{ form.is_superuser.id_for_label }}" class="form-check-label">{{ form.is_superuser.label }}</label>
            </div>
        </div>
    </div>
    <hr class="my-4">

    {# --- CAMPOS MANY-TO-MANY (SÓ APARECEM NA EDIÇÃO, SEM add_class) --- #}
    {% if form.instance.pk %}
        <div class="mb-3">
            <h5 class="mt-4">Grupos</h5>
            <div class="row"> {# Envolve os seletores em uma linha Bootstrap para melhor layout #}
                <div class="col-12">
                    {{ form.groups }} {# Renderiza o widget FilteredSelectMultiple diretamente #}
                </div>
            </div>
        </div>
        <div class="mb-3">
            <h5 class="mt-4">Filiais Permitidas</h5>
            <div class="row"> {# Envolve os seletores em uma linha Bootstrap para melhor layout #}
                <div class="col-12">
                    {{ form.filiais_permitidas }} {# Renderiza o widget FilteredSelectMultiple diretamente #}
                </div>
            </div>
        </div>
    {% endif %}

</fieldset>
