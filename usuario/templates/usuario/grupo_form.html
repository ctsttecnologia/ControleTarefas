{# templates/usuario/grupo_form.html #}

{% extends 'base.html' %}
{% load static %}

{% load widget_tweaks %}

{% block title %}{% if form.instance.pk %}Editar Grupo{% else %}Criar Novo Grupo{% endif %}{% endblock %}

{% block extra_head %}
    {{ form.media.css }}
    <style>
        .container { max-width: 900px; }
        .card-body.p-4.p-md-5 { padding: 2rem !important; }
        /* Adicione aqui os outros estilos do seletor de permissões que já estavam funcionando */
        .selector { display: flex; justify-content: space-between; gap: 15px; flex-wrap: wrap; }
        .selector .selector-available, .selector .selector-chosen { flex: 1; min-width: 280px; border: 1px solid #dee2e6; border-radius: 0.25rem; overflow: hidden; display: flex; flex-direction: column; }
        .selector-filter input { width: calc(100% - 10px) !important; margin: 5px !important; border: 1px solid #ced4da; border-radius: 0.25rem; }
        .selector-available h2, .selector-chosen h2 { font-size: 1.1rem; background-color: #f8f9fa; padding: 0.75rem 1rem; margin-bottom: 0; border-bottom: 1px solid #dee2e6; }
        .selector select { border: none; height: 250px; flex-grow: 1; }
        .selector .selector-control { display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 5px; }
        .selector .selector-control a { font-size: 1.5rem; border: 1px solid #ced4da; border-radius: 0.25rem; text-decoration: none; color: #343a40; background-color: #e9ecef; padding: 0 5px; }
    </style>
{% endblock %}

{% block content %}
    {% include 'usuario/includes/submenu.html' %}
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-12">
                <div class="card shadow-sm">
                    <div class="card-header"><h2 class="h4 mb-0">Gerenciar Grupo</h2></div>
                    <div class="card-body p-4 p-md-5">
                        <form method="post">
                            {% csrf_token %}
                            <fieldset class="module aligned">
                                
                                <div class="row mb-3 align-items-center">
                                    <label for="{{ form.name.id_for_label }}" class="col-md-3 col-form-label text-md-end">{{ form.name.label }}</label>
                                    <div class="col-md-9">
                                        {{ form.name|add_class:"form-control" }}
                                    </div>
                                </div>
                                <hr class="my-4">

                                <div class="mt-4">
                                    <h5 class="mb-3">{{ form.permissions.label }}</h5>
                                    {{ form.permissions }}
                                </div>

                            </fieldset>
                            <div class="d-flex justify-content-end gap-2 mt-4 pt-4 border-top">
                                <a href="{% url 'usuario:grupo_lista' %}" class="btn btn-secondary">Cancelar</a>
                                <button type="submit" class="btn btn-primary px-4">Salvar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
    <script src="{% url 'admin:jsi18n' %}"></script>
    {{ form.media.js }}
{% endblock %}
