{% extends 'usuario/base_usuario.html' %}

{% block title %}Gerenciar Grupos de {{ usuario_alvo.username }}{% endblock %}

{% block usuario_content %}
<div class="card shadow-sm">
    <div class="card-header"><h2 class="h4 mb-0">Gerenciar Grupos para: <strong>{{ usuario_alvo.get_full_name }}</strong></h2></div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h5>Grupos Atuais</h5>
                <ul class="list-group">
                    {% for grupo in grupos_usuario %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            {{ grupo.name }}
                            <form method="post" action="{% url 'usuario:gerenciar_grupos_usuario' pk=usuario_alvo.pk %}" class="d-inline">
                                {% csrf_token %}
                                <input type="hidden" name="grupo" value="{{ grupo.pk }}">
                                <input type="hidden" name="acao" value="remover">
                                <button type="submit" class="btn btn-sm btn-danger">&times;</button>
                            </form>
                        </li>
                    {% empty %}
                        <li class="list-group-item">Este usuário não pertence a nenhum grupo.</li>
                    {% endfor %}
                </ul>
            </div>
            <div class="col-md-6">
                <h5>Grupos Disponíveis</h5>
                <ul class="list-group">
                    {% for grupo in grupos_disponiveis %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            {{ grupo.name }}
                            <form method="post" action="{% url 'usuario:gerenciar_grupos_usuario' pk=usuario_alvo.pk %}" class="d-inline">
                                {% csrf_token %}
                                <input type="hidden" name="grupo" value="{{ grupo.pk }}">
                                <input type="hidden" name="acao" value="adicionar">
                                <button type="submit" class="btn btn-sm btn-success">+</button>
                            </form>
                        </li>
                    {% empty %}
                        <li class="list-group-item">Não há grupos disponíveis para adicionar.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="mt-4 border-top pt-3">
             <a href="{% url 'usuario:lista_usuarios' %}" class="btn btn-secondary">Voltar para Lista de Usuários</a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
    <script src="{% url 'admin:jsi18n' %}"></script>
    {{ form.media.js }}
{% endblock %}

