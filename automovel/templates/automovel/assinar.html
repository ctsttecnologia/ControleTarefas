{% extends "automovel/base.html" %}

{% block title %}Assinar Agendamento{% endblock %}

{% block extra_css %}

{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const canvas = document.getElementById('signature-pad');
        const signaturePad = new SignaturePad(canvas);
        
        document.getElementById('clear').addEventListener('click', function() {
            signaturePad.clear();
        });
        
        document.getElementById('save').addEventListener('click', function() {
            if (signaturePad.isEmpty()) {
                alert('Por favor, forne√ßa sua assinatura.');
            } else {
                const signatureInput = document.getElementById('id_assinatura');
                signatureInput.value = signaturePad.toDataURL();
                document.forms[0].submit();
            }
        });
    });
</script>
{% endblock %}

{% block content %}
<h1>Assinar Agendamento</h1>
<p>Agendamento: {{ agendamento.carro }} - {{ agendamento.data_hora_agenda }}</p>

<form method="post">
    {% csrf_token %}
    <input type="hidden" name="assinatura" id="id_assinatura">
    
    <div class="mb-3">
        <label class="form-label">Assinatura:</label>
        <canvas id="signature-pad" class="signature-pad" width="400" height="200"></canvas>
    </div>
    
    <button type="button" id="clear" class="btn btn-secondary">Limpar</button>
    <button type="button" id="save" class="btn btn-primary">Salvar Assinatura</button>
    <a href="{% url 'automovel:lista_agendamentos' %}" class="btn btn-danger">Cancelar</a>
</form>
{% endblock %}


