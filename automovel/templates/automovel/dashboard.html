{% extends 'automovel/base.html' %}
{% load static %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<head>
    <!-- Outras tags head... -->
    <link rel="stylesheet" href="{% static 'csscarro/base.css' %}">
    <link rel="stylesheet" href="{% static 'csscarro/styles.css' %}">
    <!-- Inclua os outros CSS apenas nas páginas que precisam deles -->

</head>
<div class="row mb-4">
    <div class="col-md-4">
        <div class="card text-white bg-success h-100">
            <div class="card-body">
                <h5 class="card-title">Carros Disponíveis</h5>
                <h1 class="display-4">{{ carros_disponiveis }}</h1>
                <a href="{% url 'automovel:carro_list' %}" class="text-white">Ver todos</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-white bg-primary h-100">
            <div class="card-body">
                <h5 class="card-title">Agendamentos Hoje</h5>
                <h1 class="display-4">{{ agendamentos_hoje }}</h1>
                <a href="{% url 'automovel:agendamento_list' %}" class="text-white">Ver todos</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-white bg-warning h-100">
            <div class="card-body">
                <h5 class="card-title">Próximas Manutenções</h5>
                <h1 class="display-4">{{ manutencao_proxima }}</h1>
                <a href="#" id="verManutencoes" class="text-white">Ver detalhes</a>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5>Últimos Agendamentos</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Funcionário</th>
                                <th>Carro</th>
                                <th>Data/Hora</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for agendamento in ultimos_agendamentos %}
                            <tr>
                                <td>{{ agendamento.funcionario }}</td>
                                <td>{{ agendamento.carro }}</td>
                                <td>{{ agendamento.data_hora_agenda|date:"d/m/Y H:i" }}</td>
                                <td>
                                    <span class="badge bg-{% if agendamento.status == 'agendado' %}info{% elif agendamento.status == 'em_andamento' %}primary{% elif agendamento.status == 'finalizado' %}success{% else %}danger{% endif %}">
                                        {{ agendamento.get_status_display }}
                                    </span>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="4" class="text-center">Nenhum agendamento recente</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5>Ações Rápidas</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="{% url 'automovel:carro_create' %}" class="btn btn-primary">
                        <i class="bi bi-car-front"></i> Cadastrar Carro
                    </a>
                    <a href="{% url 'automovel:agendamento_create' %}" class="btn btn-success">
                        <i class="bi bi-calendar-plus"></i> Novo Agendamento
                    </a>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown">
                            <i class="bi bi-file-earmark-arrow-down"></i> Relatórios
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{% url 'automovel:relatorio_carros' 'excel' %}">Exportar Carros (Excel)</a></li>
                            <li><a class="dropdown-item" href="{% url 'automovel:relatorio_carros' 'word' %}">Exportar Carros (Word)</a></li>
                           
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal para Manutenções -->
<div class="modal fade" id="manutencaoModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Próximas Manutenções</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="manutencaoModalBody">
                <p>Carregando...</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

