{% extends "automovel/base.html" %}
{% load static %}
{% block title %}Lista de Agendamentos{% endblock %}
{% block content %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'cssglobal/styles.css' %}">
    <link rel="stylesheet" href="{% static 'csscarro/assinatura.css' %}">
</head>
<body>
    <div class="container">
        {% if user.is_authenticated %}
        <p>Olá, {{ user.username }}!</p>
        {% else %}
            <a href="{% url 'home' %}" class="btn-home">Início</a>
        {% endif %}

        <h2>Lista de Agendamentos</h2>
        
        <a href="{% url 'home' %}" class="btn-home">Início</a>
        <a href="{% url 'usuario:logout' %}" class="btn_logout">Sair</a>               
        <a href="{% url 'automovel:adicionar_agendamento' %}" class="btn_profile">Novo Agendamento</a>
        <a href="{% url 'profile' %}" class="btn_profile">Menu</a>

        <div class="painel1">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Carro</th>
                        <th>Funcionário</th>
                        <th>Data/Hora Agenda</th>
                        <th>Data/Hora Devolução</th>
                        <th>KM Inicial</th>
                        <th>Descrição</th>
                        <th>Assinatura</th>
                        <th>Status</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for agendamento in agendamentos %}
                    <tr>
                        <td>{{ agendamento.carro }}</td>
                        <td>{{ agendamento.funcionario }}</td>
                        <td>{{ agendamento.data_hora_agenda }}</td>
                        <td>{{ agendamento.data_hora_devolucao|default:"-" }}</td>
                        <td>{{ agendamento.km_inicial }}</td>
                        <td>{{ agendamento.descricao }}</td>
                        <td>
                            {% if agendamento.assinatura %}
                                <span class="badge bg-success">Assinado</span>
                            {% else %}
                                <span class="badge bg-warning text-dark">Pendente</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if agendamento.cancelar_agenda == 'S' %}
                                <span class="badge bg-danger">Cancelado</span>
                            {% else %}
                                <span class="badge bg-success">Ativo</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'automovel:editar_agendamento' agendamento.pk %}" 
                               class="signature">Editar</a>
                            <a href="{% url 'automovel:excluir_agendamento' agendamento.pk %}" 
                               class="signature">Excluir</a>
                            {% if not agendamento.assinatura %}
                            <a href="{% url 'automovel:assinar_agendamento' agendamento.pk %}" 
                               class="signature">Assinar</a>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="9">Nenhum agendamento cadastrado.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <a href="{% url 'automovel:exportar_pdf' 'agendamentos' %}" class="btn-home">
            <i class="fas fa-file-pdf"></i> Exportar PDF
        </a>
        <a href="{% url 'automovel:exportar_excel' 'agendamentos' %}" class="btn_logout">
            <i class="fas fa-file-excel"></i> Exportar Excel
        </a>
        <a href="{% url 'automovel:dashboard' %}" class="btn_logout">
            <i class="fas fa-file-excel"></i> Graficos
        </a>

    </div>
</body>
</html>
{% endblock %}


