
{% extends "departamento_pessoal/_base_dp.html" %}
{% load i18n %}

{% block title %}{% trans "Documentos da Equipa" %}{% endblock %}

{% block dp_content %}

<div class="container py-4">
<header class="d-flex justify-content-between align-items-center mb-4 pb-2 border-bottom">
<h2 class="h3 mb-0">
<i class="bi bi-file-earmark-text-fill me-2"></i>{% trans "Os Documentos da Equipa" %}
</h2>
<a href="{% url 'departamento_pessoal:documento_create' %}" class="btn btn-primary">
<i class="bi bi-file-earmark-plus-fill me-1"></i> {% trans "Adicionar novo documento" %}
</a>
</header>

<div class="card border-0 shadow-sm">
    <div class="card-body">
        <div class="mb-4">
            <form method="get" class="row g-2 align-items-center">
                <div class="col">
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-filter"></i></span>
                        <select name="tipo" id="tipo" class="form-select">
                            <option value="">{% trans "Escolhe o tipo de documento..." %}</option>
                            {% for tipo_val, tipo_display in tipos_documento %}
                            <option value="{{ tipo_val }}" {% if request.GET.tipo == tipo_val %}selected{% endif %}>
                                {{ tipo_display }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-auto">
                    <button type="submit" class="btn btn-outline-primary">{% trans "Vamos lá!" %}</button>
                </div>
                <div class="col-auto">
                    <a href="{% url 'departamento_pessoal:lista_documentos' %}" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-counterclockwise"></i>
                    </a>
                </div>
            </form>
        </div>

        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead>
                    <tr>
                        <th scope="col">{% trans "Pessoa" %}</th>
                        <th scope="col">{% trans "Tipo de Documento" %}</th>
                        <th scope="col">{% trans "Número" %}</th>
                        <th scope="col" class="text-center">{% trans "Anexo" %}</th>
                        <th scope="col" class="text-end">{% trans "Ações" %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for documento in object_list %}
                    <tr>
                        <td>
                            <a href="{% url 'departamento_pessoal:detalhe_funcionario' documento.funcionario.pk %}">
                                {{ documento.funcionario.nome_completo }}
                            </a>
                        </td>
                        <td>{{ documento.get_tipo_documento_display }}</td>
                        <td>{{ documento.numero|default:"-" }}</td>
                        <td class="text-center">
                            {% if documento.anexo %}
                                <a href="{{ documento.anexo.url }}" target="_blank" class="btn btn-sm btn-outline-secondary">
                                    <i class="bi bi-paperclip"></i> {% trans "Ver" %}
                                </a>
                            {% else %}
                                <span class="text-muted fst-italic">{% trans "Nenhum" %}</span>
                            {% endif %}
                        </td>
                        <td class="text-end">
                            <a href="{% url 'departamento_pessoal:editar_documentos' pk=documento.pk %}" class="btn btn-sm btn-outline-primary" title="{% trans "Editar" %}">
                                <i class="bi bi-pencil-fill"></i> {% trans "Editar" %}
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5" class="text-center py-5">
                            <i class="bi bi-file-earmark-x fs-1 text-secondary"></i>
                            <h5 class="mt-3">{% trans "Uhm, não encontramos nenhum documento..." %}</h5>
                            <p class="text-muted">{% trans "Hora de adicionar o primeiro documento!" %}</p>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        {% if is_paginated %}
            {% include 'includes/pagination.html' %}
        {% endif %}
    </div>
</div>

</div>

{% endblock %}

