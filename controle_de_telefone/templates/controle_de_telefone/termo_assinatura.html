
{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}Assinatura do Termo de Responsabilidade{% endblock %}

{% block extra_head %}
<style>
    body {
        background-color: #f8f9fa;
    }
    .termo-container {
        max-width: 800px;
        margin: 2rem auto;
        background-color: #fff;
        padding: 2rem 3rem;
        border: 1px solid #dee2e6;
        box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.1);
        font-family: 'Times New Roman', Times, serif;
        font-size: 12pt;
        line-height: 1.6;
    }
    .termo-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        border-bottom: 1px solid #ccc;
        padding-bottom: 1rem;
        margin-bottom: 1.5rem;
    }
    .termo-header img {
        max-width: 150px;
    }
    .termo-header h1 {
        text-align: center;
        font-size: 14pt;
        font-weight: bold;
        margin-top: 1rem;
        width: 100%;
    }
    .termo-body strong {
        font-weight: bold;
    }
    .item-table {
        width: 100%;
        border-collapse: collapse;
        margin: 1.5rem 0;
    }
    .item-table th, .item-table td {
        border: 1px solid #333;
        padding: 8px;
        text-align: left;
    }
    .item-table th {
        background-color: #D9D9D9;
        font-weight: bold;
    }
    .clausulas {
        list-style-type: none;
        padding-left: 0;
    }
    .clausulas li {
        margin-bottom: 0.5rem;
    }
    #signature-pad {
        border: 2px dashed #ccc;
        cursor: crosshair;
        background-color: #f7f7f7;
    }
    .signature-wrapper {
        text-align: center;
        margin-top: 2rem;
    }
    .signature-info {
        margin-top: 0.5rem;
        font-size: 10pt;
    }
</style>
{% endblock %}

{% block content %}
<div class="termo-container">
    <header class="termo-header">
        <img src="{% static 'images/logocetest.png' %}" alt="Logo da Empresa">
        <h1>TERMO DE RESPONSABILIDADE SOBRE USO DE SMARTPHONE</h1>
    </header>

    <div class="termo-body">
        <p>
            A empresa <strong>CETEST MINAS ENGENHARIA E SERVIÇOS S.A</strong>, nesta data de <strong>{{ vinculo.data_entrega|date:"d \d\e F \d\e Y" }}</strong>,
            entrega ao funcionário do contrato CM {{ vinculo.funcionario.cliente.contrato|default:"N/A" }} um aparelho com as seguintes características:
        </p>

        <table class="item-table">
            <thead>
                <tr>
                    <th>DESCRIÇÃO DOS ITENS ENTREGUES</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1 CELULAR {{ vinculo.aparelho.modelo.marca.nome|default:"Marca não informada" }} {{ vinculo.aparelho.modelo.nome|default:"Modelo não informado" }} - IMEI: {{ vinculo.aparelho.imei|default:"N/A" }}</td>
                </tr>
                <tr>
                    <td>1 CHIP {{ vinculo.linha.plano.operadora.nome|default:"Operadora não informada" }} ({{ vinculo.linha.numero|default:"N/A" }})</td>
                </tr>
                <tr>
                    <td>1 ACESSÓRIO: {{ vinculo.aparelho.acessorios|default:"N/A" }}</td>
                </tr>
            </tbody>
        </table>

        <p>
            O Celular de propriedade da CETEST MINAS ENGENHARIA E SERVIÇOS S.A ficará a partir desta data sob sua inteira responsabilidade, 
            devendo ser mantido em perfeito estado de conservação e funcionamento, 
            não podendo em qualquer hipótese ser cedido a terceiros sem prévia e escrita concordância da CETEST MINAS ENGENHARIA E SERVIÇOS S.A,
            obedecendo as cláusulas seguintes:
        </p>

        <ol class="clausulas">
            <li><strong>1-</strong> A empresa NÃO autoriza o portador a receber e enviar conteúdo inadequado ou ilegal.</li>
            <li><strong>2-</strong> Será de responsabilidade do usuário responder por qualquer forma de comunicação que demonstre preconceito, assédio, ou participação em negócios exclusos aos propósitos da empresa.</li>
            <li><strong>3-</strong> Fica aos cuidados do(a) Sr.(a) <strong>{{ vinculo.funcionario.nome_completo }}</strong> a guarda e conservação do aparelho e acessórios, devendo restituí-los quando solicitado ou em caso de rescisão, sob pena de responsabilizar-se por danos.</li>
            <li><strong>4-</strong> Fica vedado permutar o equipamento ou seus acessórios. É proibida a troca do e-mail e senha fornecida pela empresa.</li>
            <li><strong>5-</strong> A qualquer momento e sem prévio aviso, a CETEST MINAS ENGENHARIA E SERVIÇOS S.A poderá solicitar a devolução imediata da linha e do aparelho.</li>
        </ol>

        <p>
            Diante das cláusulas descritas, declaro que recebi os equipamentos em perfeito estado e autorizo o desconto em
            folha de pagamento dos valores de ligações particulares ou danos por mau uso.
        </p>

        <hr>
        
        <form id="signature-form" method="post">
            {% csrf_token %}
            <div class="signature-wrapper">
                <p><strong>Assine no quadro abaixo:</strong></p>
                <canvas id="signature-pad" width="400" height="200"></canvas>
                <div class="signature-info">
                    <p class="mb-0"><strong>{{ vinculo.funcionario.nome_completo }}</strong></p>
                    <p class="mb-2"><small>RG: {{ rg_numero|default:"Documento não encontrado" }}</small></p>
                    <button type="button" id="clear-button" class="btn btn-sm btn-secondary">Limpar</button>
                </div>
            </div>

            <input type="hidden" name="assinatura_base64" id="assinatura_base64">

            <div class="d-flex justify-content-end mt-4 pt-3 border-top">
                <a href="{{ vinculo.get_absolute_url }}" class="btn btn-light me-2">Cancelar</a>
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-lg"></i> Assinar e Salvar Termo
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>

<script src="{% static 'js/signature.js' %}"></script>
{% endblock %}
